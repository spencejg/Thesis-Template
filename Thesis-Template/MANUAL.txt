This is the template for the Ph.D. thesis following the guidelines set out by the School of Graduate Studies at McMaster University. This is an alteration of the Reed College Thesis Template by Chester Ismay.

-----------------------------------------------------------------------------------------

This template will allow you to write your thesis in one file without having to worry about formatting. It uses the very useful package 'bookdown'. This package allows for cross-referencing within your thesis making it very easy for the reader to navigate and for the author to edit. Another benefit is that this will allow for reproduceable research; something becoming paramount in the academic environment. Finally, using this template to its full potential will allow you to only write any tables, reference results, or write conditional sentances once and they will automatically update themselves if you are to make any quantitative changes.

The language that you will be using is rmarkdown which is different than Latex which many of us are familiar with. The following website gives you very easy to follow instructions for using rmarkdown (https://www.rstudio.com/wp-content/uploads/2015/02/rmarkdown-cheatsheet.pdf). Keeping this cheatsheet handy will be very useful.

-----------------------------------------------------------------------------------------

How to get started.

1) It is highly recommended that before you begin that you have the latest versions of R and Rstudio. There are a few packages which are essential for this template to work properly, execute the following lines in the console. 


install.packages("devtools")
devtools::install_github("rstudio/bookdown")
devtools::install_github("ismayc/thesisdown")
install.packages("yaml")
install.packages("knitr")
install.packages("rmarkdown")




2) You need to enter your personal information (eg, name, advisor, title of your thesis, etc...) by opening the folder "prelim" and making the necessary changes to the files. There is a file called "halftitle", the School of Graduate Studies requires that you give a short title to your thesis that would appear on the spine of the bound copy. The file "authorshort" is meant to be the first letter of your given name and your full surname.


3) To knit the whole project you need to open the "index.Rmd" file and click "knit". You can also read the section below regarding how to use bash commands to knit your thesis. 

4) To write your thesis, including the abstract and other preliminary pages, open the "chapter" folder and alter the necessary files.

5) To view the pdf version, open it in the folder "_book" but it should automatically open for you when you knit your thesis.

6) Drink plenty of water.


-----------------------------------------------------------------------------------------

There are folders meant for any figures, data, and bibliography files. It is best to keep everything in their appointed folder as this will make your life easier.

-----------------------------------------------------------------------------------------

If you wish to have the file name of the output something other than "Thesis.pdf" you can change it by opening the "_bookdown.yml" file and altering the "book_filename:". If you need the MS word version of your thesis you can output into MS word by uncommenting "thesisdown::thesis_word: default" however the pdf version is advised.

-----------------------------------------------------------------------------------------

If you prefer to use STATA as your statistical package then you can still use this template to its potential. You will have to add a few lines of code to "index.Rmd" that you can find at http://www.ssc.wisc.edu/~hemken/Stataworkshops/Stata%20and%20R%20Markdown/Statalinux.html

Notice that several common programming languages are supported within Rstudio. You can find more information on this here https://rmarkdown.rstudio.com/lesson-5.html

-----------------------------------------------------------------------------------------

If you wish to start your chapters in new .Rmd files instead of using the current chapter files then begin writting your chapters and then you must change the file "_bookdown.yml" by telling it what rmd files you want compiled and in what order.

-----------------------------------------------------------------------------------------


Pandoc will not always recognize figures that are directly generated by R and this can cause havoc with your figure numbering. My suggestion is to save each plot/graphic that you generate and then use a custom function (\addfigure) to then display the graphic. This may also be useful depending on how you organize your .Rmd chapter file; it can allow for the flexibility of performing all analysis at the start of the file but then displaying graphics throughout. 

To use \addfigure you have to include five arguments: \addfigure{<name>}{<Top caption>}{<Bottom caption>}{<width>}{<label>}

A few things to notice. First, the name will most likely include the path (eg, figure/chapter1_figures/figure1). The Top caption contains the figure number so to be consistent with overall formating, however you can leave this option blank so that only the figure number will appear at the top. The bottom caption will not contain a figure number and can also be left blank. The fourth argument is width is typically 80% however you can change this to be whatever you like. Finally, in order to reference the figure later, you should include a label (NOTE: labels throughout cannot have spaces, underscore, hyphens, periods, etc..., they can only be alphanumeric) to which you can then reference that specific figure by using the command \ref{<label>}. Read the prepared Chapter 1 for more detail on labelling. 

An example:

```{r example}
data <- faithful

png(filename = 'figure/Faithful.png')
plot(faithful$eruptions, faithful$waiting)
dev.off()
```

\addfigure{figure/Faithful}{Old Faithful}{eruptions and waiting}{0.8}{label}



You can also use the jpg() or pdf() R functions to save your graphics in those formats. 

------------------------------------------------------------------------------------------


For those of you who don't necessarily want to use the GUI you can include a bash command that will make compiling your thesis very easy to do. (NOTE: for Windows users I suggest installing 'cygwin' which is free software that allows for Unix commands to be employed.). Navigate to your root directory and edit .bash_profile (I suggest either nano or emacs). Include the following to the end of the .bash_profile document:


####################################################################################
#### knit a bookdown document ####

# Command to render bookdown document
## Specifically 'index.Rmd' for Thesis
bookdown() {
echo " "
echo "##############################################"
echo " "
echo "Building Thesis"
echo " "
echo "##############################################"


# First remove Thesis.Rmd if it exists
if [ -e Thesis.Rmd ]
then
	rm Thesis.Rmd
fi


# Command to build
Rscript -e 'bookdown::render_book("index.Rmd")'
#
#
echo " "
echo "##############################################"
echo " "



# Check whether it was a failed build
if [ -e Thesis.Rmd ]
then
        echo "Build Status: FAILED"
else
        echo "Build Status: SUCCESS"
fi
echo " "
echo "##############################################"
echo " "

# Option to delete auxilary files
if [ -e Thesis.Rmd ]
then
        while true; do
                read -p "Do you want to delete the .log file? " yn
                case $yn in
                        [Yy]* ) rm Thesis.log Thesis.tex Thesis.Rmd; break;;
                        [Nn]* ) break;;
                        * ) echo "Please answer yes or no." ;;
                esac
        done
fi
}




Save the .bash_profile file and then in the terminal type:

$ source .bash_profile


Now while you are in your thesis directory you can just type the command 

$ bookdown

It will knit your thesis without having to open the Rstudio GUI. Pretty cool!

